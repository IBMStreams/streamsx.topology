<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Streamsx.topology</title>
    <style>
      .toc .h3 {
      font-size: 16px;
      margin-top: 0px;
      margin botton: 8px;
      }
      .toc .h4 {
      font-size: 14px;
      margin-left: 4em;
      }

    </style>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="stylesheets/bootstrap.css" media="screen">
    <link rel="stylesheet" href="stylesheets/bootswatch.min.css">


    <!-- <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
         <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
         <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
         <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen"> -->

  </head>
  <body>
    <div class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <a href="index.html" class="navbar-brand">streamsx.topology</a>
          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
        </div>
        <div class="navbar-collapse collapse" id="navbar-main">
          <ul class="nav navbar-nav">
            <li>
              <a href="https://github.com/Ibmstreams/streamsx.topology/releases">Releases</a>
            </li>
            <li>
              <a href="doc.html">Documentation</a>
            </li>
            <li>
              <a href="FAQ.html">FAQ</a>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li><a href="https://github.com/IBMStreams" target="_blank">An IBM Streams Project</a></li>
            <li><a href="https://github.com/IBMStreams/streamsx.topology" target="_blank">Project Page</a></li>
          </ul>

        </div>
      </div>
    </div>

    <!-- Begin main content -->

    <div class="container">
      <div class="page-header" id="banner">
        <div class="row">
        </div>
      </div>

      <section class="main-content">
	<h3> Table of contents</h3>
	<div class="toc">
	</div>      
	<h3>Streams Domain and Instance</h3>

	To run your application in distributed mode, you need a Streams Domain and a Streams Instance.  A domain is a logical grouping of resources (or containers) in a network for common management and administration.  It can contain one or more instances that share a security model, and a set of domain services.

	An instance is the Streams distributed runtime environment.  It is composed of a set of interacting services running across one or multiple resources.  The Streams Instance is responsible for running Streams applications.  When an application is submitted onto a Streams instance, it distributes the application code onto each of the resources.  It coordinates with the instance services to execute the processing elements.
	<h3>Setting up a Development Domain and Instance</h3>

	To set up a development domain and instance, follow these steps.  A development domain and instance runs on a single host.  You can dynamically add additional host to the domain later.

	First, if you have not already done so, set up the necessary environment variables by running the streamsprofile.sh.

	<pre>
    source  &lt;Streams_Install>/bin/streamsprofile.sh
	</pre>

	Next, start streamstool by typing the following command:

	<pre>
    streamtool
	</pre>

	When prompted to provide a ZooKeeper ensemble, enter the ZooKeeper ensemble string if you have a ZooKeeper server set up.  Otherwise, press enter to use the embedded ZooKeeper.

	streamtool is an interactive tool.  To get content assist and auto-complete,  press &lt;Tab>.
	<h4>
	  Domain
	</h4>

	To make a new domain, enter this command in the streamtool interactive command session:

	<pre>
    mkdomain -d &lt;domainName>
	</pre>

	Generate public and private key for Streams, so you do not have to keep logging in:

	<pre>
    genkey
	</pre>

	Start the domain:

	<pre>
    startdomain
	</pre>

	<b>Tip:</b>  If the domain fails to start because a port is in use, you may change the port number by using setdomainproperty.  For example, if JMX and SWS ports are in use:

	<pre>
    setdomainproperty jmx.port=&lt;jmxPort> sws.port=&lt;sws.Port>
	</pre>

	<h4>
	  Instance
	</h4>
	To make a new instance, enter this command:

	<pre>
    mkinstance -i &lt;instance-id>
	</pre>

	Start the instance:

	<pre>
    startinstance
	</pre>

	<h3>
	  Running Streams Applications in Distributed Mode
	</h3>

	Now that you have a domain and instance started, you can run your application in distributed mode.  To submit a job, find the application bundle file (*.sab), and run the following command:

	<pre>
    streamtool submitjob appBundleName.sab
	</pre>

	To submit our sample application, we will change into the output directory of the application and submit the application bundle:

	<pre>
    cd output/application.TradesAppMain/
    streamtool submitjob application.TradesAppMain.sab
	</pre>

	<h3>
	  Querying for Job Status
	</h3>

	You may query job status from your Streams Instance using streamtool commands.

	If using embedded ZooKeeper:

	<pre>
    streamtool lsjob -d &lt;streamsDomainName> -i &lt;instanceName> --embeddedzk
	</pre>

	If using external ZooKeeper ensemble:

	<pre>
    streamtool lsjob -d &lt;streamsDomainName> -i &lt;instanceName> --zkconnect &lt;zooKeeperHost>:&lt;zooKeeperPort>
	</pre>

	You will see job status similar to this:

	<pre>
    [streamsadmin@streamsqse Distributed]$ streamtool lsjobs -d StreamsDomain -i StreamsInstance --embeddedzk
    Instance: StreamsInstance
    Id State Healthy User Date Name Group
    6 Running yes streamsadmin 2015-04-30T18:32:48-0400 application::TradesAppMain_6 default
	</pre>
      </section>
      <script src="javascripts/jquery-2.1.4.js"></script>
      <script src="javascripts/toc.min.js"></script>
      <script>
	$('.toc').toc({'selectors': 'h3,h4', //elements to use as headings
	'container': 'body', //element to find all selectors in
	'smoothScrolling': true, //enable or disable smooth scrolling on click
	'prefix': 'toc', //prefix for anchor tags and class names
	'onHighlight': function(el) {}, //called when a new section is highlighted 
	'highlightOnScroll': true, //add class to heading that is currently in focus
	'highlightOffset': 100, //offset to trigger the next headline
	'anchorName': function(i, heading, prefix) { //custom function for anchor name
        return prefix+i;
	},
	'headerText': function(i, heading, $heading) { //custom function building the header-item text
        return $heading.text();
	},
	'itemClass': function(i, heading, $heading, prefix) { // custom function for item class
	return $heading[0].tagName.toLowerCase();
	}});
      </script>
  </body>
</html>
