<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0) on Tue Oct 10 09:59:07 PDT 2017 -->
<title>FunctionContext (Java Application API for IBM Streams)</title>
<meta name="date" content="2017-10-10">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="FunctionContext (Java Application API for IBM Streams)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6,"i1":6,"i2":6,"i3":6,"i4":6,"i5":6,"i6":6,"i7":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div role="navigation" title ="TOP_Navigation" aria-label ="Top Navigation Bar"/>
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContainer.html" title="interface in com.ibm.streamsx.topology.function"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/ibm/streamsx/topology/function/Initializable.html" title="interface in com.ibm.streamsx.topology.function"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/ibm/streamsx/topology/function/FunctionContext.html" target="_top">Frames</a></li>
<li><a href="FunctionContext.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div role="main" title ="FunctionContext" aria-labelledby ="Header1"/>
<div class="header">
<div class="subTitle">com.ibm.streamsx.topology.function</div>
<h2 title="Interface FunctionContext" class="title" id="Header1">Interface FunctionContext</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public interface <span class="typeNameLabel">FunctionContext</span></pre>
<div class="block">Context for a function executing in a IBM Streams application.</div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#addClassLibraries-java.lang.String:A-">addClassLibraries</a></span>(java.lang.String[]&nbsp;libraries)</code>
<div class="block">Add class libraries to the functional class loader.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#createCustomMetric-java.lang.String-java.lang.String-java.lang.String-java.util.function.LongSupplier-">createCustomMetric</a></span>(java.lang.String&nbsp;name,
                  java.lang.String&nbsp;description,
                  java.lang.String&nbsp;kind,
                  java.util.function.LongSupplier&nbsp;value)</code>
<div class="block">Create a custom metric.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getChannel--">getChannel</a></span>()</code>
<div class="block">Get the index of the parallel channel the function is on.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContainer.html" title="interface in com.ibm.streamsx.topology.function">FunctionContainer</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getContainer--">getContainer</a></span>()</code>
<div class="block">Get the container hosting a function</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>java.util.Set&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getCustomMetricNames--">getCustomMetricNames</a></span>()</code>
<div class="block">Get the set of custom metric names created in this context.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getMaxChannels--">getMaxChannels</a></span>()</code>
<div class="block">Get the total number of parallel channels for the parallel region that
 the function is in.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>java.util.concurrent.ScheduledExecutorService</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getScheduledExecutorService--">getScheduledExecutorService</a></span>()</code>
<div class="block">Return a scheduler to execute background tasks.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>java.util.concurrent.ThreadFactory</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getThreadFactory--">getThreadFactory</a></span>()</code>
<div class="block">Return a ThreadFactory that can be used by the function with the thread context
 class loader set correctly.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getContainer--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getContainer</h4>
<pre><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContainer.html" title="interface in com.ibm.streamsx.topology.function">FunctionContainer</a>&nbsp;getContainer()</pre>
<div class="block">Get the container hosting a function</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Container hosting a function.</dd>
</dl>
</li>
</ul>
<a name="getScheduledExecutorService--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getScheduledExecutorService</h4>
<pre>java.util.concurrent.ScheduledExecutorService&nbsp;getScheduledExecutorService()</pre>
<div class="block">Return a scheduler to execute background tasks. Functions should utilize
 this service or <a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getThreadFactory--"><code>getThreadFactory()</code></a> rather than creating their own threads
 to ensure that the SPL runtime will wait for any background work
 before completing an application.
 <P>
 The scheduler will be shutdown when the processing element is to be shutdown.
 Once the scheduler is shutdown no new tasks will be accepted. Existing
 scheduled tasks will remain in the scheduler's queue but periodic tasks
 will canceled.
 <BR>
 Functions that implement <code>AutoCloseable</code> that wish to complete any outstanding tasks
 at close time can call <code>ExecutorService.awaitTermination()</code>
 to wait for outstanding tasks to complete or wait on the specific
 <code>Future</code> reference for a task.
 </P>
 
 <P>
 The returned scheduler service is guaranteed to be an instance
 of <code>java.util.concurrent.ScheduledThreadPoolExecutor</code>
 and initially has this configuration:
 <UL>
 <LI> <code>corePoolSize</code> Set to <code>Runtime.availableProcessors()</code> with
 a minimum of 2 and maximum of 8. </LI>
 <LI> <code>allowsCoreThreadTimeOut()</code> set to <code>true</code></LI>
 <LI> <code>keepAliveTime</code> set to 5 seconds</LI>
 </UL>
 Threads are created on demand to execute tasks, so that even if the
 <code>corePoolSize</code> is eight, eight threads will only be created if
 there are eight concurrent tasks scheduled. Threads will be removed
 if they are not needed for the <code>keepAliveTime</code> value and
 <code>allowsCoreThreadTimeOut()</code> returns <code>true</code>.
 </P></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Scheduler service that can be used by the function.</dd>
<dt><span class="seeLabel">See Also:</span></dt>
<dd>"java.util.concurrent.ExecutorService", 
"java.util.concurrent.Future", 
"java.util.concurrent.ScheduledThreadPoolExecutor"</dd>
</dl>
</li>
</ul>
<a name="getThreadFactory--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getThreadFactory</h4>
<pre>java.util.concurrent.ThreadFactory&nbsp;getThreadFactory()</pre>
<div class="block">Return a ThreadFactory that can be used by the function with the thread context
 class loader set correctly. Functions should utilize
 the returned factory to create Threads.
 <P>
 Threads returned by the ThreadFactory have not been started
 and are set as daemon threads. Functions may set the threads
 as non-daemon before starting them. The SPL runtime will wait
 for non-daemon threads before terminating a processing
 element in standalone mode.
 </P>
 <P>
 Any uncaught exception thrown by the <code>Runnable</code> passed
 to the <code>ThreadFactory.newThread(Runnable)</code> will cause
 the processing element containing the function to terminate.
 </P>
 <P>
 The ThreadFactory will be shutdown when the processing element is to be shutdown.
 Once the ThreadFactory
 is shutdown a call to <code>newThread()</code> will return null.
 </P></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>A ThreadFactory that can be used by the function.</dd>
</dl>
</li>
</ul>
<a name="getChannel--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getChannel</h4>
<pre>int&nbsp;getChannel()</pre>
<div class="block">Get the index of the parallel channel the function is on.
 <P>
 If the function is in a parallel region, this method returns a value from
 0 to N-1, where N is the <a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getMaxChannels--"><code>number of channels in the parallel region</code></a>;
 otherwise it returns -1.
 </P></div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the index of the parallel channel if the
         function is executing in a parallel region, or -1 if the function
         is not executing in a parallel region.</dd>
</dl>
</li>
</ul>
<a name="getMaxChannels--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMaxChannels</h4>
<pre>int&nbsp;getMaxChannels()</pre>
<div class="block">Get the total number of parallel channels for the parallel region that
 the function is in. If the function is not in a parallel region, this
 method returns 0.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the number of parallel channels for the parallel region that this
         function is in, or 0 if the function is not in a parallel region.</dd>
</dl>
</li>
</ul>
<a name="addClassLibraries-java.lang.String:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addClassLibraries</h4>
<pre>void&nbsp;addClassLibraries(java.lang.String[]&nbsp;libraries)
                throws java.net.MalformedURLException</pre>
<div class="block">Add class libraries to the functional class loader. The functional
 class loader is set as the thread context class loader for
 <a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getThreadFactory--"><code>thread factory</code></a>,
 <a href="../../../../../com/ibm/streamsx/topology/function/FunctionContext.html#getScheduledExecutorService--"><code>executor</code></a> and any method
 invocation on the function instance.
 <P>
 Functions use this method to add class libraries specific
 to the invocation in
 a consistent manner. An example is defining the jar files that
 contain the JDBC driver to be used by the application.
 <P>
 Each element of <code>libraries</code> is trimmed and then converted 
 into a <code>java.net.URL</code>. If the element cannot be converted
 to a <code>URL</code> then it is assumed to represent a file system
 path and is converted into an <code>URL</code> representing that path.
 If the file path is relative the used location is currently
 undefined, thus use of relative paths are not recommended.
 <BR>
 If a file path ends with <code>/* </code> then it is assumed to
 be a directory and all jar files in the directory
 with the extension <code>.jar</code> or <code>.JAR</code> are
 added to the function class loader.
 </P></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>libraries</code> - String representations of URLs and file paths to be
 added into the functional class loader. If <code>null</code> then no libraries
 are added to the class loader.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.net.MalformedURLException</code></dd>
</dl>
</li>
</ul>
<a name="createCustomMetric-java.lang.String-java.lang.String-java.lang.String-java.util.function.LongSupplier-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createCustomMetric</h4>
<pre>void&nbsp;createCustomMetric(java.lang.String&nbsp;name,
                        java.lang.String&nbsp;description,
                        java.lang.String&nbsp;kind,
                        java.util.function.LongSupplier&nbsp;value)</pre>
<div class="block">Create a custom metric.
 <BR>
 A custom metric allows monitoring of an application through
 IBM Streams monitoring APIs including Streams console and the REST apis.
 
 A metric has a single <code>long</code> value and has a kind of:
 <UL>
 <LI><code>counter</code> - A counter metric observes a value that
 represents a count of an occurrence.</LI>
 <LI><code>gauge</code> - A gauge metric observes a value that is continuously variable with time.
 <LI><code>time</code> - A time metric represents a point in time. It is recommended that the
 value represents the number of milliseconds since the 1970/01/01 epoch, i.e. a
 value consistent with <code>System.currentTimeMillis()</code>.
 </UL>
 <BR>
 The initial value of the metric is set from <code>value.getAsLong()</code> during this
 method call. Subsequently, periodically <code>value.getAsLong()</code> will be called
 to get the current value of the metric so that it can be reported through the monitoring APIs.
 <P>
 A lambda expression can be used as the supplier, for example to monitor the length
 of a queue (or any collection) <code>items</code> a metric can be created from
 <a href="../../../../../com/ibm/streamsx/topology/function/Initializable.html#initialize-com.ibm.streamsx.topology.function.FunctionContext-"><code>Initializable.initialize(FunctionContext)</code></a> as:
 <pre>
 <code>
     this.items = new PriorityQueue();
     functionContext.createCustomMetric("queuedItems", "Number of queued items.",
               "gauge", () -> this.items.size());
 </code>
 </pre>
 The metric will now automatically track the length of the queue (subject to the
 periodic collection cycle).
 </P>
 <P>
 A <code>java.util.concurrent.atomic.AtomicLong</code> can be used as a metric's value,
 for example a counter where no other natural value exists, e.g.:
 <pre>
 <code>
     this.nFailedRequests = new AtomicLong();
     functionContext.createCustomMetric("nFailedRequests", "Number of failed requests.",
               "counter", this.nFailedRequests::get);
 </code>
 </pre>
 Subsequently the counter is incremented using:
 <pre>
 <code>
     this.nFailedRequests.incrementAndGet();
 </code>
 </pre>
 </P></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>name</code> - Name of the metric.</dd>
<dd><code>description</code> - Description of the metric.</dd>
<dd><code>kind</code> - Kind of the metric.</dd>
<dd><code>value</code> - function that returns the value of the metric</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code>java.lang.IllegalStateException</code> - A metric with <code>name</code> already exists or <code>kind</code> is
 not valid.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.7</dd>
</dl>
</li>
</ul>
<a name="getCustomMetricNames--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>getCustomMetricNames</h4>
<pre>java.util.Set&lt;java.lang.String&gt;&nbsp;getCustomMetricNames()</pre>
<div class="block">Get the set of custom metric names created in this context.
 
 The set may include additional metrics not created by this function
 including metric created by the topology framework.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The set of custom metric names created in this context.</dd>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>1.7</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div role="navigation" title ="Bottom_NAVIGATION" aria-label ="Bottom Navigation Bar"/>
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage">streamsx.topology 1.7 @ IBMStreams GitHub</div>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../com/ibm/streamsx/topology/function/FunctionContainer.html" title="interface in com.ibm.streamsx.topology.function"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../com/ibm/streamsx/topology/function/Initializable.html" title="interface in com.ibm.streamsx.topology.function"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/ibm/streamsx/topology/function/FunctionContext.html" target="_top">Frames</a></li>
<li><a href="FunctionContext.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
