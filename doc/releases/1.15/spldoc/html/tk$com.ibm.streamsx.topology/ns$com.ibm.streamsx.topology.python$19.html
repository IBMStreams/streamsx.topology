<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="Extracting SPL operators from Python"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_page"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>Extracting SPL operators from Python</title>
</head>
<body id="spldoc_page">


<h1 class="title topictitle1">Extracting SPL operators from Python</h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Toolkits</a> &gt; <a class="xref" href="tk$com.ibm.streamsx.topology.html">com.ibm.streamsx.topology 1.15.9</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.topology.python.html">com.ibm.streamsx.topology.python</a> &gt; <a class="xref" href="ns$com.ibm.streamsx.topology.python$4.html">Creating SPL Operators from Python code</a> &gt; Extracting SPL operators from Python</p>

</div>


<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle">Overview
</h2>

<p class="p">To create SPL operators in a toolkit, execute:
</p>

<div class="p">
<pre class="pre codeblock">
spl-python-extract -i toolkit-directory
</pre>


</div>

<p class="p">When not using the <tt class="ph tt">streamsx</tt> package then the extraction script is available in the <tt class="ph tt">bin</tt> directory of this toolkit.
</p>

<div class="p">
<pre class="pre codeblock">
python3 spl-python-extract.py -i toolkit-directory
</pre>


</div>

<p class="p">Any Python module in the toolkit's <tt class="ph tt">opt/python/streams</tt> directory will have its decorated classes and functions converted to SPL operators.
</p>

<div class="p">These directories in a toolkit are automatically added to the Python search path during execution of an operator.
<ul class="ul">
<li class="li"> <tt class="ph tt">opt/python/streams</tt> - Contains modules that define Python callables that will be created as SPL operators</li>

<li class="li"> <tt class="ph tt">opt/python/packages</tt> - Root directory for Python <a class="xref" href="https://docs.python.org/3.4/tutorial/modules.html#packages">packages</a> hierarchy.</li>

<li class="li"> <tt class="ph tt">opt/python/modules</tt> - Arbitrary <a class="xref" href="https://docs.python.org/3.4/tutorial/modules.html#modules">modules</a>, not defined as a packages.</li>

<li class="li"> <tt class="ph tt">impl/nl</tt> - The directory for the resource files.</li>

</ul>

</div>

<p class="p">A single Python embedded runtime is used by an SPL processing element (PE), thus when multiple operators implemented in python are fused into the same PE they share the same runtime. The library and include paths to the Python runtime are set from the version of Python used to execute <tt class="ph tt">spl-python-extract</tt>.
</p>

<p class="p">The toolkit has no dependency on this toolkit (<tt class="ph tt">com.ibm.streamsx.topology</tt>) once <tt class="ph tt">spl-python-extract</tt> has been executed.
</p>

<div class="p">The toolkit is extended with resources files <tt class="ph tt">impl/nl/&lt;locale&gt;/TopologySplpyResource.xlf</tt>. These resource files must be added to the  the <tt class="ph tt">resource</tt> section in file <tt class="ph tt">info.xml</tt>. The spl-python-extract.py program prepares or checks the info.xml file in the project directory
<ul class="ul">
<li class="li"> if the info.xml does not exist in the project directory, it copies the template info.xml into the project directory.    The project name is obtained from the project directory name</li>

<li class="li"> If there is a info.xml file, the resource section is inspected. If the resource section has no valid message set    description for the TopologySplpy Resource a warning message is printed'''.</li>

</ul>

</div>

<p class="p">The sample SPL toolkit <tt class="ph tt">samples/python/com.ibm.streamsx.topology.pysamples</tt> contains <tt class="ph tt">opt/python/streams/spl_samples.py</tt> for examples of how data is passed into and out of Python from SPL, using positional arguments.
</p>

<p class="p">E.g.
</p>

<div class="p">
<pre class="pre codeblock">
spl-python-extract -i samples/python/com.ibm.streamsx.topology.pysamples
</pre>


</div>

</div>

<div class="section"><h2 class="title sectiontitle">Usage
</h2>

<div class="p">
<pre class="pre codeblock">
usage: spl-python-extract [-h] -i DIRECTORY [--make-toolkit]

Extract SPL operators from decorated Python classes and functions.

optional arguments:
  -h, --help            show this help message and exit
  -i DIRECTORY, --directory DIRECTORY
                        Toolkit directory
  --make-toolkit        Index toolkit using spl-make-toolkit
</pre>


</div>

</div>

</div>


</body>
</html>